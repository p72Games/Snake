<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assault Course - Dominion Games</title>
<style>
:root {
  --bg: #000;
  --fg: #00ff88;
  --accent: #00e5ff;
  --danger: #ff3366;
}
body {
  margin: 0;
  background: radial-gradient(1200px 1200px at 50% 10%, #00121a 0%, #000 60%);
  color: var(--fg);
  font-family: "Courier New", monospace;
  text-align: center;
  padding: 20px;
}
h1 {
  font-size: clamp(24px, 5vw, 36px);
  margin-bottom: 10px;
  color: #a0fff2;
  text-shadow: 0 0 10px var(--fg), 0 0 24px var(--accent);
}
#game-container {
  position: relative;
  width: 400px;
  max-width: 95vw;
  height: 600px;
  background: rgba(0, 0, 0, 0.8);
  border: 2px solid var(--accent);
  border-radius: 8px;
  box-shadow: 0 0 12px var(--accent);
  margin: 0 auto;
}
#game-canvas {
  width: 100%;
  height: 100%;
}
#score {
  position: absolute;
  top: 20px;
  left: 20px;
  font-size: 20px;
  color: var(--fg);
  text-shadow: 0 0 5px var(--accent);
}
#game-over {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0, 0, 0, 0.9);
  border: 2px solid var(--danger);
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 0 15px var(--danger);
  color: var(--fg);
  width: 80%;
  max-width: 350px;
}
#game-over h2 {
  margin: 0 0 10px;
  font-size: 24px;
  color: var(--danger);
}
#restart-btn {
  background: var(--accent);
  border: 2px solid var(--fg);
  border-radius: 8px;
  padding: 10px 20px;
  font-family: "Courier New", monospace;
  font-size: 16px;
  color: var(--bg);
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}
#restart-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 0 10px var(--fg);
}
.instructions-box {
  max-width: 400px;
  margin: 20px auto;
  padding: 15px;
  background: rgba(0,0,0,0.7);
  border: 2px solid var(--accent);
  border-radius: 12px;
  box-shadow: 0 0 12px var(--accent);
  text-align: left;
  line-height: 1.5;
}
.instructions-box h2 {
  margin-top: 0;
  color: #a0fff2;
  text-align: center;
}
.instructions-box p {
  color: var(--fg);
  margin: 0.5em 0;
}
.touchBtn {
  background:#022;
  border:1px solid var(--accent);
  padding:28px;
  border-radius:50%;
  font-size:26px;
  color:var(--fg);
  user-select:none;
  margin: 8px auto;
  display: block;
}
footer {
  margin-top: 20px;
  font-size: 14px;
  opacity: 0.7;
}
a {
  color: var(--accent);
  text-decoration: none;
  font-size: 14px;
}
a:hover {
  text-decoration: underline;
}
</style>
</head>
<body>
<h1>Assault Course</h1>

<div id="game-container">
  <canvas id="game-canvas" width="400" height="600"></canvas>
  <div id="score">Score: 0 | High: 0</div>
  <div id="game-over">
    <h2>Game Over</h2>
    <p>Score: <span id="final-score">0</span></p>
    <button id="restart-btn">Restart</button>
  </div>
</div>

<div class="instructions-box">
  <h2>How to Play</h2>
  <p>Tap the screen or press the Spacebar to make the block jump.</p>
  <p>Navigate through the gaps in the pillars. Hitting a pillar or falling ends the game.</p>
  <p>Each gap successfully passed scores 1 point. Try to beat your high score!</p>
  <p>Mobile players can use the buttons below the instructions to jump easily.</p>
  <button class="touchBtn" onclick="jump()">⬆️ Jump</button>
</div>

<a href="index.html">Back to Arcade</a>
<footer>© Dominion Games</footer>

<script>
const canvas = document.getElementById('game-canvas');
const ctx = canvas.getContext('2d');
const scoreDisplay = document.getElementById('score');
const gameOverScreen = document.getElementById('game-over');
const finalScoreDisplay = document.getElementById('final-score');
const restartBtn = document.getElementById('restart-btn');

let block = { x: 100, y: 300, size: 30, velocity: 0, gravity: 0.5, jump: -10 };
let pillars = [];
let score = 0;
let gameRunning = true;
const pillarWidth = 50;
const pillarSpeed = 2;
let frameCount = 0;
const minGap = 120;
const maxGap = 280;
let highScore = localStorage.getItem('assaultCourseHighScore') || 0;
scoreDisplay.textContent = `Score: ${score} | High: ${highScore}`;

function updateHighScore() {
  if (score > highScore) {
    highScore = score;
    localStorage.setItem('assaultCourseHighScore', highScore);
    scoreDisplay.textContent = `Score: ${score} | High: ${highScore}`;
  }
}

function addPillar(isFirst = false) {
  if (isFirst) {
    const gapSize = 220;
    const gapY = (canvas.height - gapSize) / 2;
    pillars.push({ x: canvas.width, gapY, gapSize, passed: false });
    return;
  }
  const gapSize = Math.random() * (maxGap - minGap) + minGap;
  const safeMargin = 60;
  const maxGapY = Math.max(safeMargin, canvas.height - gapSize - safeMargin);
  const gapY = Math.random() * (maxGapY - safeMargin) + safeMargin;
  pillars.push({ x: canvas.width, gapY, gapSize, passed: false });
}

// Input handling
function jump() {
  if (gameRunning) block.velocity = block.jump;
}

document.addEventListener('keydown', e => {
  if (e.code === 'Space') {
    e.preventDefault(); // prevents page scroll
    jump();
  }
});
canvas.addEventListener('click', jump);

// Restart
restartBtn.addEventListener('click', () => {
  block.y = 300;
  block.velocity = 0;
  pillars = [];
  score = 0;
  scoreDisplay.textContent = `Score: ${score} | High: ${highScore}`;
  gameOverScreen.style.display = 'none';
  gameRunning = true;
  frameCount = 0;
  addPillar(true);
  gameLoop();
});

// Game loop
function gameLoop() {
  if (!gameRunning) return;
  block.velocity += block.gravity;
  block.y += block.velocity;
  if (block.y + block.size > canvas.height || block.y < 0) endGame();

  if (frameCount % 90 === 0) addPillar();
  pillars.forEach(pillar => {
    pillar.x -= pillarSpeed;
    if (
      block.x + block.size > pillar.x &&
      block.x < pillar.x + pillarWidth &&
      (block.y < pillar.gapY || block.y + block.size > pillar.gapY + pillar.gapSize)
    ) endGame();

    if (!pillar.passed && block.x > pillar.x + pillarWidth) {
      score++;
      scoreDisplay.textContent = `Score: ${score} | High: ${highScore}`;
      pillar.passed = true;
    }
  });
  pillars = pillars.filter(p => p.x + pillarWidth > 0);

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = '#ff0000';
  ctx.shadowColor = 'var(--fg)';
  ctx.shadowBlur = 10;
  ctx.fillRect(block.x, block.y, block.size, block.size);
  ctx.shadowBlur = 0;

  ctx.fillStyle = '#00e5ff';
  ctx.shadowColor = '#00e5ff';
  ctx.shadowBlur = 20;
  pillars.forEach(p => {
    ctx.fillRect(p.x, 0, pillarWidth, p.gapY);
    ctx.fillRect(p.x, p.gapY + p.gapSize, pillarWidth, canvas.height);
  });
  ctx.shadowBlur = 0;

  frameCount++;
  requestAnimationFrame(gameLoop);
}

function endGame() {
  gameRunning = false;
  gameOverScreen.style.display = 'block';
  finalScoreDisplay.textContent = score;
  updateHighScore();
}

// Start game
addPillar(true);
gameLoop();
</script>
</body>
</html>
